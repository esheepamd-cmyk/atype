<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>@type — мини‑соцсеть</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 100vh;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #4a76a8 0, #101722 55%, #050608 100%);
      color: #f5f7fa;
      display: flex;
      flex-direction: column;
      align-items: stretch;
    }
    a { color: #8ab4ff; text-decoration: none; }

    /* Шапка */
    .topbar {
      height: 52px;
      background: rgba(5, 11, 20, 0.9);
      border-bottom: 1px solid rgba(255,255,255,0.05);
      color: #fff;
      display: flex;
      align-items: center;
      padding: 0 20px;
      backdrop-filter: blur(14px);
      position: sticky;
      top: 0;
      z-index: 10;
    }
    .topbar-logo {
      font-weight: 800;
      font-size: 20px;
      letter-spacing: 0.04em;
      margin-right: 16px;
    }
    .topbar-logo span {
      color: #8ab4ff;
    }
    .topbar-search {
      flex: 1;
    }
    .topbar-search input {
      width: 100%;
      max-width: 320px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,0.16);
      background: rgba(10, 20, 35, 0.9);
      color: #f5f7fa;
      font-size: 13px;
      outline: none;
    }
    .topbar-search input::placeholder {
      color: rgba(245,247,250,0.45);
    }
    .topbar-right {
      margin-left: auto;
      font-size: 13px;
      opacity: 0.9;
    }

    /* Центровка приложения */
    .app-shell {
      flex: 1;
      display: flex;
      justify-content: center;
      padding: 24px 12px 32px;
    }
    .app-frame {
      width: 100%;
      max-width: 980px;
      min-height: 520px;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.12);
      background: radial-gradient(circle at top left, rgba(255,255,255,0.12), rgba(9,16,28,0.96));
      box-shadow:
        0 18px 40px rgba(0,0,0,0.55),
        0 0 0 1px rgba(255,255,255,0.02);
      overflow: hidden;
      display: grid;
      grid-template-columns: 220px minmax(0, 1fr) 230px;
      gap: 0;
      color: #e8edf6;
    }

    /* Левое меню */
    .sidebar {
      padding: 16px 14px;
      border-right: 1px solid rgba(255,255,255,0.08);
      background: linear-gradient(180deg, rgba(10,20,35,0.85), rgba(7,13,23,0.95));
      font-size: 13px;
    }
    .sidebar-section {
      margin-bottom: 14px;
    }
    .sidebar-title {
      font-size: 11px;
      text-transform: uppercase;
      color: rgba(211,220,235,0.7);
      margin-bottom: 6px;
      letter-spacing: 0.06em;
    }
    .menu-item {
      padding: 6px 8px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #dbe4ff;
      cursor: pointer;
      transition: background 0.12s ease, transform 0.05s ease;
    }
    .menu-item span.icon {
      width: 20px;
      text-align: center;
      opacity: 0.8;
    }
    .menu-item:hover {
      background: rgba(138,180,255,0.12);
      transform: translateY(-0.5px);
    }
    .menu-item.active {
      background: linear-gradient(90deg, rgba(138,180,255,0.2), rgba(138,180,255,0.05));
      border: 1px solid rgba(138,180,255,0.45);
    }

    /* Контент */
    .content {
      padding: 16px 16px 18px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      background: radial-gradient(circle at top, rgba(22,35,60,0.92), rgba(6,10,18,0.98));
    }

    .card {
      background: rgba(9,17,32,0.9);
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.06);
      box-shadow: 0 12px 32px rgba(0,0,0,0.5);
      padding: 10px 12px;
    }
    .card-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 6px;
    }
    .card-title {
      font-weight: 600;
      font-size: 14px;
      color: #f5f7fa;
    }
    .card-sub {
      font-size: 11px;
      color: rgba(214,222,235,0.7);
    }
    label {
      display: block;
      margin-bottom: 4px;
      font-size: 12px;
      color: rgba(214,222,235,0.85);
    }
    input[type="text"],
    input[type="password"],
    textarea {
      width: 100%;
      padding: 7px 9px;
      border-radius: 9px;
      border: 1px solid rgba(197,208,219,0.5);
      background: rgba(6,11,22,0.9);
      color: #f5f7fa;
      font-size: 13px;
      font-family: inherit;
      outline: none;
    }
    input::placeholder,
    textarea::placeholder {
      color: rgba(180,192,210,0.55);
    }
    textarea {
      resize: vertical;
      min-height: 58px;
      max-height: 170px;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 12px;
      cursor: pointer;
      font-family: inherit;
      transition: background 0.12s ease, transform 0.05s ease, box-shadow 0.12s ease;
      white-space: nowrap;
    }
    .btn-primary {
      background: linear-gradient(135deg, #8ab4ff, #4a76a8);
      color: #05080f;
      box-shadow: 0 6px 16px rgba(138,180,255,0.35);
    }
    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 24px rgba(138,180,255,0.4);
    }
    .btn-secondary {
      background: rgba(229,235,241,0.1);
      color: #dbe4ff;
      border: 1px solid rgba(229,235,241,0.25);
    }

    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-top: 6px;
    }

    .posts {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 420px;
      overflow-y: auto;
      padding-right: 4px;
    }

    .post {
      border-radius: 12px;
      padding: 7px 9px;
      background: linear-gradient(135deg, rgba(26,34,54,0.95), rgba(9,15,27,0.98));
      border: 1px solid rgba(255,255,255,0.04);
    }
    .post-header {
      display: flex;
      justify-content: space-between;
      gap: 6px;
      font-size: 12px;
      color: rgba(200,211,228,0.85);
    }
    .post-author {
      font-weight: 600;
      color: #dbe4ff;
    }
    .post-time {
      white-space: nowrap;
      color: rgba(176,188,205,0.8);
    }
    .post-text {
      margin-top: 4px;
      font-size: 13px;
      color: #f5f7fa;
      white-space: pre-wrap;
      word-wrap: break-word;
    }

    .empty {
      font-size: 12px;
      color: rgba(176,188,205,0.85);
      text-align: center;
      padding: 10px 0;
    }
    .small {
      font-size: 11px;
      color: rgba(170,182,200,0.85);
      margin-top: 4px;
    }

    /* Правая колонка */
    .rightbar {
      padding: 14px 14px 12px;
      border-left: 1px solid rgba(255,255,255,0.08);
      background: linear-gradient(180deg, rgba(9,15,27,0.97), rgba(5,9,17,0.98));
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Экран логина */
    .auth-overlay {
      position: fixed;
      inset: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      background: radial-gradient(circle at top, rgba(10,16,30,0.9), rgba(1,1,3,0.96));
      z-index: 20;
    }
    .auth-card {
      width: 100%;
      max-width: 360px;
      padding: 18px 18px 16px;
      border-radius: 18px;
      background: radial-gradient(circle at top left, rgba(255,255,255,0.09), rgba(9,12,23,0.97));
      border: 1px solid rgba(255,255,255,0.14);
      box-shadow:
        0 18px 40px rgba(0,0,0,0.8),
        0 0 0 1px rgba(255,255,255,0.02);
    }
    .auth-title {
      font-size: 16px;
      font-weight: 650;
      margin-bottom: 4px;
    }
    .auth-sub {
      font-size: 12px;
      color: rgba(205,214,230,0.85);
      margin-bottom: 10px;
    }

    /* страницы */
    .page { display: none; }
    .page-active { display: block; }

    @media (max-width: 900px) {
      .app-frame {
        grid-template-columns: 64px minmax(0, 1fr);
      }
      .rightbar { display: none; }
      .sidebar {
        padding: 12px 6px;
      }
      .sidebar-title { display: none; }
      .menu-item span.label { display: none; }
      .menu-item {
        justify-content: center;
      }
    }

    @media (max-width: 640px) {
      .app-frame {
        max-width: 100%;
        border-radius: 0;
        border: none;
      }
      .topbar { border-radius: 0; }
    }
  </style>
</head>
<body>
  <div class="topbar">
    <div class="topbar-logo">@<span>type</span></div>
    <div class="topbar-search">
      <input type="text" placeholder="Поиск по @type (пока только декор)">
    </div>
    <div class="topbar-right" id="topbarUser">
      Не авторизован
    </div>
  </div>

  <!-- Экран логина/регистрации -->
  <div id="page-auth" class="auth-overlay">
    <div class="auth-card">
      <div class="auth-title">Вход в @type</div>
      <div class="auth-sub">Создай локальный аккаунт и зайди в свою мини‑ленту.</div>

      <label for="loginName">Логин</label>
      <input type="text" id="loginName" placeholder="логин">

      <label for="loginPass" style="margin-top:6px;">Пароль</label>
      <input type="password" id="loginPass" placeholder="пароль">

      <div class="btn-group" style="margin-top:10px;">
        <button class="btn-primary" id="loginBtn">Войти</button>
        <button class="btn-secondary" id="registerBtn">Зарегистрироваться</button>
      </div>
      <div class="small" id="authHint">
        Аккаунты и посты хранятся локально в этом браузере (без сети).
      </div>
    </div>
  </div>

  <div class="app-shell">
    <div class="app-frame">
      <!-- Левое меню -->
      <aside class="sidebar">
        <div class="sidebar-section">
          <div class="sidebar-title">Навигация</div>
          <div class="menu-item active" data-nav="news">
            <span class="icon">★</span><span class="label">Лента</span>
          </div>
          <div class="menu-item" data-nav="profile">
            <span class="icon">☺</span><span class="label">Профиль</span>
          </div>
        </div>
        <div class="sidebar-section">
          <div class="sidebar-title">Аккаунт</div>
          <div class="menu-item" id="logoutLink">
            <span class="icon">⇦</span><span class="label">Выход</span>
          </div>
        </div>
      </aside>

      <!-- Центр -->
      <main class="content">
        <!-- страница новости -->
        <section id="section-news" class="page page-active">
          <div class="card">
            <div class="card-header">
              <div>
                <div class="card-title">Что у вас нового?</div>
                <div class="card-sub">Запишите мысль — она появится в вашей ленте.</div>
              </div>
            </div>
            <label for="postInput">Текст поста</label>
            <textarea id="postInput" placeholder="Напишите что‑нибудь..."></textarea>
            <div class="btn-group">
              <button class="btn-primary" id="addPostBtn">Опубликовать</button>
            </div>
          </div>

          <div class="card">
            <div class="card-header">
              <div class="card-title">Моя лента</div>
              <div class="card-sub" id="feedSub">Вы ещё ничего не публиковали.</div>
            </div>
            <div id="postsContainer" class="posts"></div>
          </div>
        </section>

        <!-- страница профиль -->
        <section id="section-profile" class="page">
          <div class="card">
            <div class="card-header">
              <div class="card-title">Мой профиль</div>
            </div>
            <div id="profileInfo" class="small" style="margin-bottom:8px;"></div>

            <label for="statusInput">Статус</label>
            <input type="text" id="statusInput" placeholder="Напишите статус...">
            <div class="btn-group">
              <button class="btn-primary" id="saveStatusBtn">Сохранить статус</button>
            </div>
            <div class="small">
              Профиль и статус привязаны к вашему логину и живут в localStorage на этом устройстве.
            </div>
          </div>
        </section>
      </main>

      <!-- Правая колонка -->
      <aside class="rightbar">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Инфо</div>
          </div>
          <div class="card-body" id="infoBox">
            Не авторизован.
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">@type</div>
          </div>
          <div class="card-body">
            <div class="small">
              Это учебная мини‑соцсеть.  
              Локальные аккаунты, локальные посты, «вайб‑кодинг» без настоящего бэкенда.
            </div>
          </div>
        </div>
      </aside>
    </div>
  </div>

  <script>
    // локальное «хранилище»
    const STORAGE_KEY_USERS = 'atype_users_ui';
    const STORAGE_KEY_POSTS = 'atype_posts_ui';
    const STORAGE_KEY_CURRENT = 'atype_current_ui';

    let users = []; // {login, passHash, status}
    let posts = []; // {author, text, time}
    let currentUser = null;

    // DOM
    const pageAuth = document.getElementById('page-auth');
    const loginName = document.getElementById('loginName');
    const loginPass = document.getElementById('loginPass');
    const loginBtn  = document.getElementById('loginBtn');
    const registerBtn = document.getElementById('registerBtn');
    const authHint  = document.getElementById('authHint');

    const topbarUser = document.getElementById('topbarUser');
    const infoBox    = document.getElementById('infoBox');
    const logoutLink = document.getElementById('logoutLink');

    const profileInfo   = document.getElementById('profileInfo');
    const statusInput   = document.getElementById('statusInput');
    const saveStatusBtn = document.getElementById('saveStatusBtn');

    const postInput       = document.getElementById('postInput');
    const addPostBtn      = document.getElementById('addPostBtn');
    const postsContainer  = document.getElementById('postsContainer');
    const feedSub         = document.getElementById('feedSub');

    const sections = {
      news: document.getElementById('section-news'),
      profile: document.getElementById('section-profile')
    };

    function loadUsers() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY_USERS);
        if (!raw) return [];
        const arr = JSON.parse(raw);
        if (Array.isArray(arr)) return arr;
        return [];
      } catch {
        return [];
      }
    }

    function saveUsers() {
      localStorage.setItem(STORAGE_KEY_USERS, JSON.stringify(users));
    }

    function loadPosts() {
      try {
        const raw = localStorage.getItem(STORAGE_KEY_POSTS);
        if (!raw) return [];
        const arr = JSON.parse(raw);
        if (Array.isArray(arr)) return arr;
        return [];
      } catch {
        return [];
      }
    }

    function savePosts() {
      localStorage.setItem(STORAGE_KEY_POSTS, JSON.stringify(posts));
    }

    function simpleHash(str) {
      let h = 0;
      for (let i = 0; i < str.length; i++) h = (h * 31 + str.charCodeAt(i)) | 0;
      return h.toString();
    }

    function getUser(login) {
      return users.find(u => u.login === login) || null;
    }

    function setCurrentUser(login) {
      currentUser = login;
      if (login) localStorage.setItem(STORAGE_KEY_CURRENT, login);
      else localStorage.removeItem(STORAGE_KEY_CURRENT);
    }

    function renderAuthState() {
      if (currentUser) {
        pageAuth.style.display = 'none';
        topbarUser.textContent = currentUser;
        infoBox.textContent = 'Вы вошли как ' + currentUser;
        renderProfile();
        renderPosts();
      } else {
        pageAuth.style.display = 'flex';
        topbarUser.textContent = 'Не авторизован';
        infoBox.textContent = 'Не авторизован.';
      }
    }

    function renderProfile() {
      if (!currentUser) return;
      const u = getUser(currentUser);
      if (!u) return;
      profileInfo.innerHTML =
        '<b>Логин:</b> ' + u.login + '<br>' +
        '<b>Статус:</b> ' + (u.status || 'нет статуса');
      statusInput.value = u.status || '';
    }

    function renderPosts() {
      postsContainer.innerHTML = '';
      if (!currentUser) return;
      const myPosts = posts
        .filter(p => p.author === currentUser)
        .sort((a, b) => new Date(b.time) - new Date(a.time));
      if (myPosts.length === 0) {
        const div = document.createElement('div');
        div.className = 'empty';
        div.textContent = 'У вас пока нет постов.';
        postsContainer.appendChild(div);
        feedSub.textContent = 'Вы ещё ничего не публиковали.';
        return;
      }
      feedSub.textContent = 'Всего записей: ' + myPosts.length;
      for (const p of myPosts) {
        const postEl = document.createElement('div');
        postEl.className = 'post';

        const header = document.createElement('div');
        header.className = 'post-header';

        const author = document.createElement('span');
        author.className = 'post-author';
        author.textContent = p.author;

        const timeSpan = document.createElement('span');
        timeSpan.className = 'post-time';
        const dt = new Date(p.time || Date.now());
        timeSpan.textContent = dt.toLocaleString();

        header.appendChild(author);
        header.appendChild(timeSpan);

        const text = document.createElement('div');
        text.className = 'post-text';
        text.textContent = p.text;

        postEl.appendChild(header);
        postEl.appendChild(text);
        postsContainer.appendChild(postEl);
      }
    }

    function showSection(name) {
      Object.entries(sections).forEach(([key, el]) => {
        if (key === name) el.classList.add('page-active');
        else el.classList.remove('page-active');
      });
      document.querySelectorAll('.menu-item[data-nav]').forEach(mi => {
        mi.classList.toggle('active', mi.getAttribute('data-nav') === name);
      });
    }

    // регистрация / логин
    function handleRegister() {
      const login = (loginName.value || '').trim();
      const pass = (loginPass.value || '').trim();
      if (!login || !pass) {
        authHint.textContent = 'Введите логин и пароль для регистрации.';
        return;
      }
      if (getUser(login)) {
        authHint.textContent = 'Такой логин уже существует.';
        return;
      }
      users.push({ login, passHash: simpleHash(pass), status: '' });
      saveUsers();
      authHint.textContent = 'Аккаунт создан, теперь можно войти.';
    }

    function handleLogin() {
      const login = (loginName.value || '').trim();
      const pass = (loginPass.value || '').trim();
      if (!login || !pass) {
        authHint.textContent = 'Введите логин и пароль.';
        return;
      }
      const u = getUser(login);
      if (!u) {
        authHint.textContent = 'Аккаунт не найден. Нажмите "Зарегистрироваться".';
        return;
      }
      if (u.passHash !== simpleHash(pass)) {
        authHint.textContent = 'Неверный пароль.';
        return;
      }
      setCurrentUser(login);
      authHint.textContent = '';
      renderAuthState();
      showSection('news');
    }

    function handleLogout() {
      setCurrentUser(null);
      renderAuthState();
    }

    function handleSaveStatus() {
      if (!currentUser) return;
      const u = getUser(currentUser);
      if (!u) return;
      u.status = statusInput.value || '';
      saveUsers();
      renderProfile();
    }

    function handleAddPost() {
      if (!currentUser) return;
      const text = (postInput.value || '').trim();
      if (!text) {
        alert('Нельзя опубликовать пустой пост.');
        return;
      }
      posts.push({
        author: currentUser,
        text,
        time: new Date().toISOString()
      });
      savePosts();
      postInput.value = '';
      renderPosts();
    }

    // события
    registerBtn.addEventListener('click', handleRegister);
    loginBtn.addEventListener('click', handleLogin);
    logoutLink.addEventListener('click', handleLogout);

    saveStatusBtn.addEventListener('click', handleSaveStatus);
    addPostBtn.addEventListener('click', handleAddPost);

    postInput.addEventListener('keydown', e => {
      if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) {
        handleAddPost();
      }
    });

    document.querySelectorAll('.menu-item[data-nav]').forEach(mi => {
      mi.addEventListener('click', () => {
        if (!currentUser) return;
        showSection(mi.getAttribute('data-nav'));
      });
    });

    // init
    users = loadUsers();
    posts = loadPosts();
    const saved = localStorage.getItem(STORAGE_KEY_CURRENT);
    if (saved && getUser(saved)) currentUser = saved;
    renderAuthState();
  </script>
</body>
</html>
